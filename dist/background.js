(()=>{const e="https://chrome-dictionary-proxy-server.vercel.app";chrome.runtime.onMessage.addListener(((t,o,r)=>"analyzeText"===t.action?(async function(t,o){try{const r=await fetch(`${e}/api/analyze`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({text:t,context:o})});if(!r.ok){const e=await r.json();throw new Error(e.error||"ANALYZING: Failed to get analysis from proxy server")}const n=await r.json();return console.log("AI RESPONSE:",n.result),n.result}catch(e){throw console.error("AI analysis error:",e),e}}(t.text,t.context).then((e=>{r({success:!0,result:e})})).catch((e=>{console.error("Error in text analysis:",e),r({success:!1,error:e.message})})),!0):"getDefinition"===t.action?(async function(t,o){try{const r=await fetch(`${e}/api/definition`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({text:t,context:o})});if(!r.ok){const e=await r.json();throw new Error(e.error||"DEFINITION: Failed to get definition from proxy server")}const n=await r.json();return console.log("AI Definition Response:",n.result),n.result}catch(e){throw console.error("AI definition error:",e),e}}(t.text,t.context).then((e=>{r({success:!0,result:e})})).catch((e=>{console.error("Error in definition",e),r({success:!1,error:e.message})})),!0):void 0))})();